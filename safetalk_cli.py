# ==========================================
# ğŸ›¡ï¸ SafeTalk CLI â€” ë³´ì´ìŠ¤í”¼ì‹±Â·ìŠ¤ë¯¸ì‹± ì¢…í•© ì˜ˆë°© í•™ìŠµ í”„ë¡œê·¸ë¨
# ==========================================
# ì‹¤í–‰: python safetalk_cli.py
# ==========================================

import random, sys

# --------------------------
# ê³µí†µ ì‹ ê³ /ìƒë‹´ ë§í¬
# --------------------------
def append_links():
    return (
        "\nğŸ“ ì‹ ê³ /ìƒë‹´ ì•ˆë‚´:\n"
        " - ê²½ì°°ì²­: 112\n"
        " - ê¸ˆìœµê°ë…ì›: 1332\n"
        " - KISA ìŠ¤íŒ¸ì‹ ê³ ì„¼í„°: https://spam.kisa.or.kr\n"
        " - ì‚¬ì´ë²„ë²”ì£„ì‹ ê³ ì‹œìŠ¤í…œ: https://ecrm.police.go.kr\n"
        " - ë³´ì´ìŠ¤í”¼ì‹± ì§€í‚´ì´: https://www.police.go.kr/crime/phishing.jsp"
    )

# --------------------------
# ì…ë ¥ ìœ í‹¸
# --------------------------
def input_text(prompt):
    v = input(prompt).strip()
    if v.lower() in ("q","quit","exit"):
        print("\nğŸšª í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•©ë‹ˆë‹¤. ì•ˆì „í•˜ê²Œ ì§€ë‚´ì„¸ìš”.")
        sys.exit(0)
    return v

def input_int(prompt, min_v, max_v):
    while True:
        try:
            v = input_text(prompt)
            n = int(v)
            if min_v <= n <= max_v:
                return n
            print(f"â†’ {min_v}~{max_v} ì‚¬ì´ ìˆ«ì ì…ë ¥")
        except ValueError:
            print("â†’ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”. (ì¢…ë£Œ:q)")

# --------------------------
# ê° ì‹œë‚˜ë¦¬ì˜¤ í€´ì¦ˆ ë°ì´í„°
# (ê°„ëµ ìš”ì•½ â€” ì‹¤ì œ ë²„ì „ì€ ì•ì„œ ë§Œë“  ìƒì„¸ ë°ì´í„° import ê°€ëŠ¥)
# --------------------------

scenarios = {
    "íƒë°° ìŠ¤ë¯¸ì‹±": [
        {"q":"â€˜CJëŒ€í•œí†µìš´ì…ë‹ˆë‹¤. ë°°ì†¡ì§€ ì˜¤ë¥˜ë¡œ ë°˜ì†¡ ì¤‘ì…ë‹ˆë‹¤.â€™ ë¬¸ìë¥¼ ë°›ì•˜ë‹¤ë©´?",
         "options":["ë§í¬ í´ë¦­","ê³ ê°ì„¼í„° ë¬¸ì˜","ì¹œêµ¬ ê³µìœ "],"answer":2,
         "explain":"íƒë°°ì‚¬ëŠ” ë¬¸ì ë§í¬ë¡œ ì£¼ì†Œ ìˆ˜ì •ì„ ìš”êµ¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê³µì‹ ì•±ì´ë‚˜ ê³ ê°ì„¼í„°ì—ì„œë§Œ í™•ì¸í•˜ì„¸ìš”."},
        {"q":"ìŠ¤ë¯¸ì‹± ë¬¸ìì—ì„œ ìì£¼ ì“°ëŠ” ì‹¬ë¦¬ëŠ”?",
         "options":["ê¸´ê¸‰í•¨Â·ë¶ˆì•ˆê°","ê¸°ì¨","ìì‹ ê°"],"answer":1,
         "explain":"ê¸´ê¸‰í•˜ê±°ë‚˜ ë¶ˆì•ˆí•œ ê°ì •ì„ ìê·¹í•´ íŒë‹¨ë ¥ì„ íë¦¬ê²Œ ë§Œë“­ë‹ˆë‹¤."},
        {"q":"â€˜ë°°ì†¡ ì˜¤ë¥˜ë¡œ ë°˜ì†¡ ì¤‘ì…ë‹ˆë‹¤â€™ ë¬¸ì¥ì˜ ëª©ì ì€?",
         "options":["ë¶ˆì•ˆê° ìœ ë„","ê¸°ì¨ ìœ ë°œ","ê´€ì‹¬ ëŒê¸°"],"answer":1,
         "explain":"â€˜ì˜¤ë¥˜â€™, â€˜ë°˜ì†¡â€™ ë“± ë¶€ì • ë‹¨ì–´ë¡œ ê¸´ê¸‰ ë°˜ì‘ì„ ìœ ë„í•©ë‹ˆë‹¤."},
    ],
    "ê³µê³µê¸°ê´€ ì‚¬ì¹­": [
        {"q":"â€˜ê·€í•˜ì˜ ëª…ì˜ê°€ ë²”ì£„ì— ì´ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.â€™ ì „í™”ë¥¼ ë°›ì•˜ë‹¤ë©´?",
         "options":["ì§ì ‘ ê²½ì°°ì²­ ë²ˆí˜¸ë¡œ í™•ì¸","ì†¡ê¸ˆ","ì£¼ë¯¼ë²ˆí˜¸ ì œê³µ"],"answer":1,
         "explain":"ê²½ì°°Â·ê²€ì°°ì€ ì „í™”ë¡œ ì†¡ê¸ˆì„ ìš”êµ¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì§ì ‘ ë²ˆí˜¸ë¡œ í™•ì¸í•˜ì„¸ìš”."},
        {"q":"ê³µê³µê¸°ê´€ì€ ì „í™”ë¡œ ì–´ë–¤ ìš”ì²­ì„ ì ˆëŒ€ í•˜ì§€ ì•ŠëŠ”ê°€?",
         "options":["ì†¡ê¸ˆ ìš”ì²­","ë¬¸ì˜ ì‘ë‹µ","í™ë³´ ì•ˆë‚´"],"answer":1,
         "explain":"ì „í™”ë¡œ ì†¡ê¸ˆ ìš”ì²­í•˜ëŠ” ê¸°ê´€ì€ ì—†ìŠµë‹ˆë‹¤."},
        {"q":"êµ­ì„¸ì²­ì€ ì„¸ê¸ˆ ë‚©ë¶€ ì•ˆë‚´ë¥¼ ì–´ë–¤ ê²½ë¡œë¡œ í• ê¹Œ?",
         "options":["í™ˆíƒìŠ¤ ê³µì‹ ì•Œë¦¼","ë¬¸ì ë§í¬","ì „í™”"],"answer":1,
         "explain":"í™ˆíƒìŠ¤ì—ì„œë§Œ ì„¸ê¸ˆ ê´€ë ¨ ì•ˆë‚´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."},
    ],
    "ê°€ì¡±/ì§€ì¸ ì‚¬ì¹­": [
        {"q":"â€˜ì—„ë§ˆ ë‚˜ íœ´ëŒ€í° ê³ ì¥ë‚¬ì–´. ëˆ ì¢€ ë³´ë‚´ì¤˜.â€™ ë¬¸ìë¥¼ ë°›ì•˜ë‹¤ë©´?",
         "options":["ë³´ë‚¸ ë²ˆí˜¸ë¡œ ì†¡ê¸ˆ","ì „í™”ë¡œ ì§ì ‘ í™•ì¸","ì¹´í†¡ í™•ì¸"],"answer":2,
         "explain":"ê°€ì¡±ì´ë‚˜ ì§€ì¸ì¼ì§€ë¼ë„ ë°˜ë“œì‹œ ë³¸ì¸ í†µí™”ë¡œ í™•ì¸í•˜ì„¸ìš”."},
        {"q":"ê°€ì¡± ì‚¬ì¹­ ìŠ¤ë¯¸ì‹±ì´ ìì£¼ ë…¸ë¦¬ëŠ” ëŒ€ìƒì€?",
         "options":["ì¤‘ì¥ë…„ì¸µ","ì²­ì†Œë…„","ì§ì¥ì¸"],"answer":1,
         "explain":"ê°€ì¡± ì‹ ë¢°ì™€ ê¸´ê¸‰ì„±ì„ ì•…ìš©í•˜ê¸° ë•Œë¬¸ì— ì£¼ë¡œ ì¤‘ì¥ë…„ì¸µì´ í‘œì ì…ë‹ˆë‹¤."},
        {"q":"â€˜ê¸‰í•˜ê²Œ ëˆ í•„ìš”â€™ ë¬¸ì¥ì˜ ì‹¬ë¦¬ëŠ”?",
         "options":["ê¸´ê¸‰ì„±Â·ì‹ ë¢° ì•…ìš©","í˜¸ê¸°ì‹¬","í¥ë¶„"],"answer":1,
         "explain":"ê¸´ê¸‰ì„±ê³¼ ê°€ì¡± ì‚¬ë‘ì„ ì•…ìš©í•´ ì†¡ê¸ˆì„ ìœ ë„í•©ë‹ˆë‹¤."},
    ],
    "ê¸ˆìœµ/ëŒ€ì¶œ ì‚¬ì¹­": [
        {"q":"â€˜ì •ë¶€ ê¸´ê¸‰ëŒ€ì¶œ ì‹ ì²­í•˜ì„¸ìš”â€™ ë¬¸ìë¥¼ ë°›ì•˜ë‹¤ë©´?",
         "options":["ìŠ¤ë¯¸ì‹± ê°€ëŠ¥ì„± ë†’ìŒ","ì •ë¶€ ê³µì‹ ì•ˆë‚´","ì€í–‰ ì´ë²¤íŠ¸"],"answer":1,
         "explain":"ì •ë¶€ê¸°ê´€ì€ ë¬¸ìë¡œ ëŒ€ì¶œì„ ë°›ì§€ ì•ŠìŠµë‹ˆë‹¤. ëª¨ë‘ ì‚¬ì¹­ì…ë‹ˆë‹¤."},
        {"q":"â€˜ì˜¤ëŠ˜ ë§ˆê°â€™ ë¬¸êµ¬ê°€ í¬í•¨ëœ ëŒ€ì¶œ ë¬¸ìì˜ ì‹¬ë¦¬ì „ëµì€?",
         "options":["ê¸´ê¸‰ì„± ìœ ë„","ì •ë³´ì œê³µ","ê°ì‚¬í‘œí˜„"],"answer":1,
         "explain":"â€˜ì§€ê¸ˆ ì•ˆ í•˜ë©´ ì†í•´â€™ ì‹¬ë¦¬ë¥¼ ìê·¹í•©ë‹ˆë‹¤."},
        {"q":"â€˜ê¸ˆë¦¬ ì¸í•˜ ì¬ëŒ€ì¶œâ€™ ë¬¸ìì˜ ëª©ì ì€?",
         "options":["ì •ë³´ íƒˆì·¨","ê¸ˆë¦¬ ì•ˆë‚´","ì‹¤ì œ ëŒ€ì¶œ"],"answer":1,
         "explain":"ê¸°ì¡´ ê³ ê°ì˜ ê°œì¸ì •ë³´ë¥¼ ë‹¤ì‹œ ë¹¼ë‚´ê¸° ìœ„í•œ ìˆ˜ë²•ì…ë‹ˆë‹¤."},
    ],
    "ë³´ì´ìŠ¤í”¼ì‹± ì‹¬í™”": [
        {"q":"â€˜ê·€í•˜ì˜ ê³„ì¢Œê°€ ë²”ì£„ì— ì´ìš©ë˜ì—ˆìŠµë‹ˆë‹¤â€™ ì „í™”ì˜ ì˜ë„ëŠ”?",
         "options":["ê¸ˆì „ íƒˆì·¨","ê³„ì¢Œ ë³´í˜¸","ì¡°ì‚¬ í˜‘ì¡°"],"answer":1,
         "explain":"ìˆ˜ì‚¬ê¸°ê´€ì€ ì ˆëŒ€ ì „í™”ë¡œ ì†¡ê¸ˆì„ ìš”êµ¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."},
        {"q":"AI ìŒì„± ë³´ì´ìŠ¤í”¼ì‹±ì˜ ì£¼ìš” íŠ¹ì§•ì€?",
         "options":["ì‹¤ì œ ì¸ë¬¼ì²˜ëŸ¼ ë“¤ë¦¼","ë‹¨ì¡°ë¡œìš´ ëª©ì†Œë¦¬","í†µí™” ë¶ˆê°€"],"answer":1,
         "explain":"AIëŠ” ì–µì–‘ê¹Œì§€ ë³µì œí•˜ì—¬ ì‹¤ì œ ê°€ì¡±ì²˜ëŸ¼ ë“¤ë¦½ë‹ˆë‹¤."},
        {"q":"â€˜ë¹„ë°€ ìœ ì§€í•˜ë¼â€™ëŠ” ë§ì˜ ì˜ë„ëŠ”?",
         "options":["ê³ ë¦½ ìœ ë„","ì‹ ë¢° ê°•í™”","ì•ˆì‹¬"],"answer":1,
         "explain":"í”¼í•´ìê°€ ì£¼ë³€ê³¼ ìƒì˜í•˜ì§€ ëª»í•˜ê²Œ ë§Œë“¤ì–´ í†µì œí•©ë‹ˆë‹¤."},
    ]
}

# --------------------------
# í€´ì¦ˆ ì‹¤í–‰ í•¨ìˆ˜
# --------------------------
def run_quiz(scenario_name, questions):
    print(f"\nğŸ§© {scenario_name} í€´ì¦ˆë¥¼ ì‹œì‘í•©ë‹ˆë‹¤! (ì´ {len(questions)}ë¬¸í•­)\n")
    random.shuffle(questions)
    score = 0

    for i, q in enumerate(questions, 1):
        print(f"\n{i}. {q['q']}")
        for j,opt in enumerate(q["options"],1):
            print(f"  {j}. {opt}")
        ans = input_int("ë‹µ â–¶ ", 1, len(q["options"]))
        if ans == q["answer"]:
            print("âœ… ì •ë‹µì…ë‹ˆë‹¤!")
            score += 1
        else:
            print(f"âŒ ì˜¤ë‹µì…ë‹ˆë‹¤. ì •ë‹µì€ {q['answer']}ë²ˆ ({q['options'][q['answer']-1]})")
        print("ğŸ’¬ í•´ì„¤:", q["explain"])
        print(append_links())
        input("\nì—”í„° â–¶ ë‹¤ìŒ ë¬¸ì œ")

    print("\n====================================")
    print(f"ğŸ¯ ìµœì¢… ì ìˆ˜: {score} / {len(questions)}")
    if score >= len(questions)*0.8:
        print("ğŸ‰ í›Œë¥­í•´ìš”! í”¼ì‹± íƒì§€ ì „ë¬¸ê°€ ìˆ˜ì¤€ì…ë‹ˆë‹¤.")
    elif score >= len(questions)*0.6:
        print("ğŸ‘ ì¢‹ìŠµë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ìˆ˜ë²•ì„ êµ¬ë³„í•  ìˆ˜ ìˆì–´ìš”.")
    else:
        print("âš ï¸ ì£¼ì˜! ì˜ì‹¬ ì—°ë½ì€ ì ˆëŒ€ ë§í¬ í´ë¦­ ê¸ˆì§€ì…ë‹ˆë‹¤.")
    print("====================================\n")

# --------------------------
# ë©”ì¸ ë£¨í”„
# --------------------------
def main():
    print("==========================================")
    print("ğŸ›¡ï¸ SafeTalk CLI â€” ë³´ì´ìŠ¤í”¼ì‹±Â·ìŠ¤ë¯¸ì‹± ì˜ˆë°© í†µí•© í•™ìŠµ")
    print("==========================================\n")

    names = list(scenarios.keys())

    while True:
        print("í•™ìŠµí•  ì£¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”:")
        for i, n in enumerate(names, 1):
            print(f" {i}. {n}")
        print(" q. ì¢…ë£Œ")

        sel = input_text("\nâ–¶ ë²ˆí˜¸ ì…ë ¥: ")
        if sel.lower() in ("q","quit","exit"):
            print("\nğŸ›‘ í”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•©ë‹ˆë‹¤. ì•ˆì „í•˜ê²Œ ì§€ë‚´ì„¸ìš”!")
            break

        if not sel.isdigit() or int(sel) not in range(1, len(names)+1):
            print("âš ï¸ ì˜¬ë°”ë¥¸ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.\n")
            continue

        scenario = names[int(sel)-1]
        run_quiz(scenario, scenarios[scenario])

        again = input_text("\në‹¤ë¥¸ ì£¼ì œë„ í•™ìŠµí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (Y/N): ").lower()
        if again != "y":
            print("\nâœ… í•™ìŠµì„ ì¢…ë£Œí•©ë‹ˆë‹¤. ìˆ˜ê³ í•˜ì…¨ìŠµë‹ˆë‹¤!")
            break

if __name__ == "__main__":
    main()