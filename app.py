# ==========================================
# ğŸ›¡ï¸ SafeTalk â€” ë³´ì´ìŠ¤í”¼ì‹±Â·ìŠ¤ë¯¸ì‹± ì˜ˆë°© í€´ì¦ˆ (Pure Streamlit)
# - ë¡œê·¸ì¸/DB/íƒ€ì´ë¨¸ ì œê±°, í€´ì¦ˆ ì§‘ì¤‘
# - ë‚œì´ë„ë³„ 10ë¬¸í•­ ìë™ìƒì„±(ì¤‘ë³µ/ë‹¨ì¡° ì˜µì…˜ ë°©ì§€)
# - ì œì¶œâ†’í•´ì„¤/ë§í¬ ë…¸ì¶œâ†’ë‹¤ìŒ ë¬¸ì œ ì§„í–‰
# ==========================================
import random
import streamlit as st

# ----------------------------
# ìŠ¤íƒ€ì¼: ëª¨ë“  í…ìŠ¤íŠ¸/ì…ë ¥ ê²€ì •, ë“œë¡­ë‹¤ìš´/ë¼ë””ì˜¤ ê°€ì‹œì„± ê³ ì •
# ----------------------------
st.set_page_config(page_title="SafeTalk Quiz", page_icon="ğŸ›¡ï¸", layout="centered")
st.markdown("""
<style>
:root { --st-fg: #111; --st-bg: #f7faff; }
.stApp { background: var(--st-bg) !important; color: var(--st-fg) !important; }
*, div, p, span, label, h1, h2, h3, h4, h5, h6 { color: var(--st-fg) !important; }
[data-testid="stMarkdownContainer"] * { color: var(--st-fg) !important; }
[data-testid="stText"], [data-testid="stNumberInput"] input,
[data-testid="stTextInput"] input, textarea {
  color:#111 !important; background:#fff !important; border:1.5px solid #aab6ff !important;
}
.stButton>button {
  background: linear-gradient(90deg,#2563eb,#1d4ed8) !important; color:#fff !important;
  border:none !important; border-radius:10px !important; padding:10px 18px !important; font-weight:700 !important;
}
.stRadio > div[role="radiogroup"] label div[data-testid="stMarkdownContainer"] p { margin: 0 !important; }
.stRadio > div[role="radiogroup"] label { gap:.5rem !important; }
[data-baseweb="select"], [data-baseweb="select"] * { color:#111 !important; background:#fff !important; }
[data-baseweb="popover"] { background:#fff !important; color:#111 !important; }
[data-baseweb="option"] { color:#111 !important; background:#fff !important; }
[data-baseweb="option"]:hover { background:#e9efff !important; }
.card { background:#fff; border-radius:18px; padding:28px; box-shadow:0 6px 25px rgba(0,0,0,.08); }
.badge { display:inline-block; padding:.2rem .55rem; border-radius:999px; font-size:.75rem; border:1px solid #dbe3ff; background:#f3f6ff; }
</style>
""", unsafe_allow_html=True)

# ----------------------------
# ìƒë‹¨ í—¤ë”
# ----------------------------
st.markdown("""
<div style="text-align:center;margin-top:10px">
  <img src="https://cdn-icons-png.flaticon.com/512/9746/9746595.png" width="70"/>
  <h1 style="font-weight:900;margin:.4rem 0">SafeTalk â€” ë³´ì´ìŠ¤í”¼ì‹±Â·ìŠ¤ë¯¸ì‹± ì˜ˆë°© í€´ì¦ˆ</h1>
  <p style="color:#334155">ì‹œë‚˜ë¦¬ì˜¤ Â· ë‚œì´ë„ ì„ íƒ â†’ ì œì¶œ í›„ í•´ì„¤/ì‹ ê³  ë§í¬ í™•ì¸ â†’ ë‹¤ìŒ ë¬¸ì œ</p>
</div>
""", unsafe_allow_html=True)

# ----------------------------
# ì‹ ê³ /í™•ì¸ ê³µì‹ ë§í¬ (í•´ì„¤ì—ì„œ ì‚¬ìš©)
# ----------------------------
LINKS = {
    "police": "[ê²½ì°° 112](tel:112)",
    "fss": "[ê¸ˆìœµê°ë…ì› 1332](tel:1332)",
    "kisa": "[KISA 118 ì‚¬ì´ë²„ë¯¼ì›](https://www.kisa.or.kr/jsp/contents/contact/cyber.jsp)",
    "hometax": "[êµ­ì„¸ì²­ í™ˆíƒìŠ¤](https://www.hometax.go.kr)",
    "cj": "[CJëŒ€í•œí†µìš´ ê³ ê°ì„¼í„°](https://www.cjlogistics.com/ko/tool/customerService)",
    "epass": "[êµí†µë¯¼ì›24 eFINE](https://www.efine.go.kr/)",
    "nhis": "[êµ­ë¯¼ê±´ê°•ë³´í—˜ê³µë‹¨(1577-1000)](https://www.nhis.or.kr)",
    "fsc_notice": "[ê¸ˆìœµì‚¬ê¸° ì˜ˆë°© ì•ˆë‚´](https://www.fss.or.kr/)",
}

# ----------------------------
# í•µì‹¬ ë¬¸í•­ ë¼ˆëŒ€ (ë‚œì´ë„ë³„ ë² ì´ìŠ¤)
# ê° í•­ëª©: (ì§ˆë¬¸, ë³´ê¸°ë¦¬ìŠ¤íŠ¸, ì •ë‹µì¸ë±ìŠ¤, í•´ì„¤í‚¤ì›Œë“œ)
#   í•´ì„¤ì€ ì•„ë˜ explain()ì—ì„œ ë§í¬ì™€ í•¨ê»˜ ìƒì„±
# ----------------------------
BASE = {
    "íƒë°° ìŠ¤ë¯¸ì‹±": {
        "easy": [
            ("â€˜ë°°ì†¡ì§€ ì˜¤ë¥˜ë¡œ ë°˜ì†¡ ì¤‘â€™ ë¬¸ìë¥¼ ë°›ì•˜ë‹¤. ì˜¬ë°”ë¥¸ 1ì°¨ ëŒ€ì‘ì€?",
             ["ë¬¸ì ë§í¬ë¡œ ì¦‰ì‹œ ìˆ˜ì •", "íƒë°°ì‚¬ ê³µì‹ ê³ ê°ì„¼í„°ë¡œ ì§ì ‘ ë¬¸ì˜", "ë³´ë‚¸ ë²ˆí˜¸ë¡œ ì „í™”í•´ í™•ì¸"], 1, "íƒë°°-ëŒ€í‘œ"),
            ("â€˜êµ­ì œíŠ¹ì†¡ í†µê´€ë²ˆí˜¸ ì˜¤ë¥˜â€™ëŠ” ë³´í†µ ì–´ë–¤ ì‹¬ë¦¬ë¥¼ ë…¸ë¦°ë‹¤?",
             ["ê¸´ê¸‰/ë¶ˆì•ˆ", "ë³´ìƒì‹¬ë¦¬", "ê´€ì‹¬ìœ ë„"], 0, "ì‹¬ë¦¬"),
            ("â€˜ë°°ì†¡ ì¡°íšŒ ìœ„í•´ ì•± ì„¤ì¹˜â€™ ìš”êµ¬ì˜ ëª©ì ì€?",
             ["í¸ì˜ ì œê³µ", "ì•…ì„±ì•± ì„¤ì¹˜ ìœ ë„", "í”„ë¡œëª¨ì…˜"], 1, "ì•…ì„±ì•±"),
            ("â€˜ë°°ì†¡ ì¤‘ ë¬¸ì œ ë°œìƒâ€™ ë¬¸ìë¥¼ ë°›ìœ¼ë©´ ê°€ì¥ ì•ˆì „í•œ ì ˆì°¨ëŠ”?",
             ["ë¬¸ì ë§í¬ í´ë¦­", "ê³µì‹ì•±/ì›¹ì—ì„œ ì§ì ‘ ì¡°íšŒ", "ë©”ì‹œì§€ íšŒì‹ "], 1, "íƒë°°-ëŒ€í‘œ"),
            ("ìŠ¤ë¯¸ì‹± ë¬¸ìì—ì„œ ì˜ì‹¬ ì‹ í˜¸ê°€ ì•„ë‹Œ ê²ƒì€?",
             ["ë‹¨ì¶•URL/ê¸´ê¸‰ ë¬¸êµ¬", "ê°œì¸ì •ë³´ ì…ë ¥ ìœ ë„", "ì •ì‹ ë„ë©”ì¸+ëŒ€í‘œë²ˆí˜¸ ì•ˆë‚´"], 2, "ì •ì‹ë„ë©”ì¸"),
        ],
        "normal": [
            ("â€˜ì£¼ì†Œë¶ˆëª…/ë°˜ì†¡/í†µê´€ë²ˆí˜¸â€™ ì¡°í•©ì˜ í•µì‹¬ ëª©ì ì€?",
             ["ë²•ì ì¡°ì¹˜ ê³ ì§€", "ê°œì¸/ê²°ì œì •ë³´ íƒˆì·¨", "ë§Œì¡±ë„ ì¡°ì‚¬"], 1, "ì •ë³´íƒˆì·¨"),
            ("ë§í¬ë¥¼ ëˆŒë €ë”ë‹ˆ ë¡œê·¸ì¸ í˜ì´ì§€ê°€ ë–´ë‹¤. ê°€ì¥ ë¨¼ì € í™•ì¸í•  í•­ëª©ì€?",
             ["ë¸Œë¼ìš°ì € í…Œë§ˆ", "ì£¼ì†Œì°½ ë„ë©”ì¸", "í°íŠ¸"], 1, "ë„ë©”ì¸"),
            ("ë°°ì†¡ì‚¬ ì‚¬ì¹­ ìŠ¤ë¯¸ì‹±ì„ ì¤„ì´ëŠ” ìŠµê´€ìœ¼ë¡œ ì˜³ì€ ê²ƒì€?",
             ["ë¬¸ì ë§í¬ ì¦‰ì‹œ í™•ì¸", "ê²€ìƒ‰í•œ ëŒ€í‘œë²ˆí˜¸ë¡œ ì¬í†µí™”", "ë©”ì‹œì§€ íšŒì‹  ìš”ì²­"], 1, "ëŒ€í‘œë²ˆí˜¸"),
            ("â€˜ì¿ í°/í¬ì¸íŠ¸ ì§€ê¸‰â€™ì„ ë‚´ì„¸ìš´ ë°°ì†¡ ë¬¸ì, ìœ„í—˜ ì´ìœ ëŠ”?",
             ["ê´‘ê³ ì¼ ë¿", "ìê¸ˆ íƒˆì·¨í˜• ìœ ë„", "ì‹¤ìˆ˜ë¡œ ë°œì†¡"], 1, "ì •ë³´íƒˆì·¨"),
            ("ì˜ì‹¬ ë¬¸ìë¥¼ ìˆ˜ì‹ í–ˆë‹¤. ì‹ ê³ /ìƒë‹´ ì°½êµ¬ëŠ”?",
             ["ì§€ì¸", "ì»¤ë®¤ë‹ˆí‹°", "112/1332/118"], 2, "ì‹ ê³ "),
        ],
        "hard": [
            ("ì•ˆë“œë¡œì´ë“œì—ì„œ ì™¸ë¶€ APK ì„¤ì¹˜ë¥¼ í—ˆìš©í•˜ë©´ ì™œ ìœ„í—˜í•œê°€?",
             ["ì„¤ì¹˜ê°€ ëŠë ¤ì§", "ì•…ì„±ì½”ë“œ ê¶Œí•œ ìƒìŠ¹ ê°€ëŠ¥", "ë°°í„°ë¦¬ ì†Œëª¨"], 1, "ì•…ì„±ì•±"),
            ("í”¼ì‹± í˜ì´ì§€ì—ì„œ â€˜https ìë¬¼ì‡ â€™ë§Œ ë³´ê³  ì•ˆì‹¬í•˜ë©´ ì•ˆ ë˜ëŠ” ì´ìœ ëŠ”?",
             ["ì˜ë¯¸ ì—†ìŒ", "í”¼ì‹±ë„ TLSë¥¼ ì“¸ ìˆ˜ ìˆìŒ", "ë¸Œë¼ìš°ì € ë²„ê·¸"], 1, "ë„ë©”ì¸"),
            ("â€˜ì•ˆì „ê²°ì œ/ë³´í˜¸ì´ì²´â€™ ì•ˆë‚´ì˜ ë³¸ì§ˆì€?",
             ["ì¼ì‹œ ëŒ€í”¼ ìˆ˜ë‹¨", "ìê¸ˆ íƒˆì·¨ ìˆ˜ë²•", "í•©ë²•ì  ì ˆì°¨"], 1, "ë³´í˜¸ì´ì²´"),
            ("ë¬¸ì ë‚´ â€˜ê³ ê°ì„¼í„°â€™ ë²ˆí˜¸ê°€ ëŒ€í‘œë²ˆí˜¸ì™€ ë‹¤ë¥´ë‹¤. ëŒ€ì‘ì€?",
             ["ê·¸ ë²ˆí˜¸ë¡œ í†µí™”", "ê²€ìƒ‰í•œ ëŒ€í‘œë²ˆí˜¸ë¡œ ì¬í™•ì¸", "ë¬¸ì íšŒì‹  ìš”ì²­"], 1, "ëŒ€í‘œë²ˆí˜¸"),
            ("ì‹¤ì œ ë°°ì†¡ ì§€ì—° ì¤‘ì´ë¼ë„ ë§í¬ í´ë¦­ì´ ìœ„í—˜í•œ ì´ìœ ëŠ”?",
             ["ì„œë²„ ê³¼ë¶€í•˜", "ë„ë©”ì¸ ìœ„ì¥+ì•…ì„±ì•± ìœ ë„", "ê´‘ê³  ê³¼ë‹¤"], 1, "ë„ë©”ì¸"),
        ],
    },
    "ê³µê³µê¸°ê´€ ì‚¬ì¹­": {
        "easy": [
            ("â€˜[ê²½ì°°ì²­] ë²”ì¹™ê¸ˆ í†µì§€ì„œ ë°œì†¡â€™ ë¬¸ìë¥¼ ë°›ì•˜ë‹¤. í™•ì¸ ë°©ë²•ì€?",
             ["ë¬¸ì URL í´ë¦­", "ê³µì‹ ì‚¬ì´íŠ¸(êµí†µë¯¼ì›24)ì—ì„œ ì§ì ‘ í™•ì¸", "ì§€ì¸ì—ê²Œ í™•ì¸"], 1, "êµí†µë¯¼ì›"),
            ("ì •ë¶€ê¸°ê´€ì€ ë¬¸ì/ì „í™”ë¡œ ì†¡ê¸ˆì„ ìš”êµ¬í•  ìˆ˜ ìˆë‹¤(O/X)",
             ["O", "X", "ìƒí™©ì— ë”°ë¼"], 1, "ì†¡ê¸ˆë¶ˆê°€"),
            ("ê±´ë³´ê³µë‹¨ ì‹¤ì œ ì•ˆë‚´ì— í¬í•¨ë  ë²•í•œ ì •ë³´ëŠ”?",
             ["ëŒ€í‘œì „í™”/ê³µì‹ ë„ë©”ì¸", "ê°œì¸ ê³„ì¢Œë²ˆí˜¸", "ì•± ì„¤ì¹˜ íŒŒì¼"], 0, "ê±´ë³´"),
            ("â€˜ì„¸ê¸ˆ í™˜ê¸‰â€™ ì•ˆë‚´ë¥¼ ë°›ì•˜ë‹¤. ì–´ë””ì„œ í™•ì¸?",
             ["ë¬¸ì ë§í¬", "êµ­ì„¸ì²­ í™ˆíƒìŠ¤", "ë°œì‹ ë²ˆí˜¸ íšŒì‹ "], 1, "í™ˆíƒìŠ¤"),
            ("ê¸°ê´€ ì‚¬ì¹­ ì˜ì‹¬ ì‹œ 1ìˆœìœ„ ì¡°ì¹˜ëŠ”?",
             ["í†µí™” ìœ ì§€", "ì¦‰ì‹œ ê°œì¸ì •ë³´ ì œê³µ", "ê³µì‹ ëŒ€í‘œë²ˆí˜¸ë¡œ ì¬í™•ì¸"], 2, "ëŒ€í‘œë²ˆí˜¸"),
        ],
        "normal": [
            ("ìˆ˜ì‚¬ê¸°ê´€ ì‚¬ì¹­ ì „í™”ì˜ ì „í˜•ì  íŠ¹ì§•ì€?",
             ["í†µí™” ì¤‘ ì†¡ê¸ˆ/ì´ì²´ ìš”êµ¬", "ë°©ë¬¸ ì•ˆë‚´", "ê³µë¬¸ ì´ë©”ì¼"], 0, "ì†¡ê¸ˆë¶ˆê°€"),
            ("â€˜ì‚¬ê±´ë²ˆí˜¸ í™•ì¸â€™ì´ë¼ë©° ë§í¬ ì ‘ì† ìš”êµ¬. ìš°ì„  í™•ì¸í•  ê²ƒ?",
             ["ë§í¬ ë””ìì¸", "ë„ë©”ì¸/ì¸ì¦ ìˆ˜ë‹¨", "í°íŠ¸"], 1, "ë„ë©”ì¸"),
            ("ì„¸ê¸ˆ ì²´ë‚© ë¬¸ìë¥¼ ë°›ì€ ê²½ìš° ì˜ëª»ëœ ëŒ€ì‘ì€?",
             ["í™ˆíƒìŠ¤ ì§ì ‘ í™•ì¸", "ë¬¸ì ë§í¬ ì ‘ì†", "ëŒ€í‘œë²ˆí˜¸ ì¬í†µí™”"], 1, "í™ˆíƒìŠ¤"),
            ("ì‚¬ì¹­ ì „í™”ê°€ ì˜ì‹¬ë  ë•Œ ì˜¬ë°”ë¥¸ ì¢…ë£Œë²•ì€?",
             ["ë°”ë¡œ ëŠê³  ëŒ€í‘œë²ˆí˜¸ë¡œ ìƒˆ í†µí™”", "ìƒëŒ€ì—ê²Œ í™”ë‚´ê¸°", "ê³„ì† ë“£ê¸°"], 0, "ëŒ€í‘œë²ˆí˜¸"),
            ("ì‹ ê³ /ìƒë‹´ ì°½êµ¬ë¡œ ì ì ˆí•œ ê³³ì€?",
             ["112/1332/118", "ì§€ì¸", "SNS"], 0, "ì‹ ê³ "),
        ],
        "hard": [
            ("â€˜ì•ˆì „ê³„ì¢Œë¡œ ì´ì²´â€™ ìš”êµ¬ê°€ í•­ìƒ í—ˆìœ„ì¸ ì´ìœ ëŠ”?",
             ["ì„ì‹œì ˆì°¨", "ë²•ìƒ ê·¸ëŸ° ê³„ì¢ŒëŠ” ì—†ìŒ", "ì¼ë¶€ í•©ë²•"], 1, "ë³´í˜¸ì´ì²´"),
            ("ê¸°ê´€ ì‚¬ì¹­ ë§í¬ê°€ httpsë¼ë„ ìœ„í—˜í•œ í•µì‹¬ ì´ìœ ëŠ”?",
             ["httpsëŠ” ì˜ë¯¸ ì—†ìŒ", "ë„ë©”ì¸ ìì²´ê°€ ìœ„ì¥ ê°€ëŠ¥", "í°íŠ¸ ë¬¸ì œ"], 1, "ë„ë©”ì¸"),
            ("í†µí™” ì¤‘ ì„¤ì¹˜ë¥¼ ê¶Œí•˜ëŠ” ì•±ì˜ ìš©ë„ëŠ” ëŒ€ì²´ë¡œ?",
             ["ë³´ì•ˆê°•í™”", "ì›ê²©ì œì–´/ê°ˆì·¨", "ì„¤ì •ë°±ì—…"], 1, "ì•…ì„±ì•±"),
            ("â€˜ê³µë™ì¡°ì‚¬íŒ€â€™ ëª…ëª©ì˜ ì†¡ê¸ˆ ìš”êµ¬ëŠ”?",
             ["í•©ë²•", "ìê¸ˆ íƒˆì·¨ ìˆ˜ë²•", "ì¼ë°˜ì  ê´€í–‰"], 1, "ë³´í˜¸ì´ì²´"),
            ("ê¸°ê´€ ì‚¬ì¹­ ì˜ˆë°© ìŠµê´€ìœ¼ë¡œ í‹€ë¦° ê²ƒì€?",
             ["ë§í¬ ëŒ€ì‹  ì§ì ‘ ì ‘ì†", "ëŒ€í‘œë²ˆí˜¸ ì¬í™•ì¸", "ë°œì‹ ë²ˆí˜¸ ì €ì¥"], 2, "ëŒ€í‘œë²ˆí˜¸"),
        ],
    },
    "ê°€ì¡±/ì§€ì¸ ì‚¬ì¹­": {
        "easy": [
            ("â€˜ì—„ë§ˆ í° ê³ ì¥â€¦ ê¸‰íˆ ëˆ í•„ìš”â€™ ë¬¸ìë¥¼ ë°›ì•˜ë‹¤. ë¨¼ì € í•  ì¼ì€?",
             ["ë°”ë¡œ ì†¡ê¸ˆ", "ì „í™”ë¡œ ë³¸ì¸ í™•ì¸", "ì¹´í†¡ ë©”ì‹œì§€ë¡œë§Œ í™•ì¸"], 1, "ë³¸ì¸í™•ì¸"),
            ("ì§€ì¸ ì‚¬ì¹­ì´ ì˜ í†µí•˜ëŠ” ì´ìœ ëŠ”?",
             ["ì•¼ë°¤ ì „ì†¡", "ê°€ì¡± ì‹ ë¢°+ê¸´ê¸‰ì„± ì•…ìš©", "010 ë²ˆí˜¸"], 1, "ì‹¬ë¦¬"),
            ("ëª¨ë°”ì¼ ì²­ì²©ì¥ ìŠ¤ë¯¸ì‹±ì˜ ëŒ€í‘œ íŠ¹ì§•ì€?",
             ["ì¹œê·¼í•œ ê²½ì¡°ì‚¬ ë§í¬", "í•´ì™¸ë°°ì†¡ ìœ„ì¥", "ì€í–‰ ë¡œê·¸ì¸ ì—°ê²°"], 0, "ë§í¬ì£¼ì˜"),
            ("í”„ë¡œí•„/ì´ë¦„ì´ ê°™ì•„ë„ í™•ì¸í•´ì•¼ í•˜ëŠ” ê²ƒ?",
             ["ëŒ€í™” ê¸¸ì´", "ìŒì„±/ì˜ìƒ ë³¸ì¸ í™•ì¸", "ì´ëª¨í‹°ì½˜"], 1, "ë³¸ì¸í™•ì¸"),
            ("ì§€ì¸ ì‚¬ì¹­ ì˜ì‹¬ ì‹œ í•˜ì§€ ë§ì•„ì•¼ í•  ì¼ì€?",
             ["ì „í™”ë¡œ í™•ì¸", "ë§í¬ ì ‘ì†", "ëŒ€í‘œë²ˆí˜¸ ë¬¸ì˜"], 1, "ë§í¬ì£¼ì˜"),
        ],
        "normal": [
            ("ê°€ì¡± ì‚¬ì¹­ì´ íŠ¹íˆ ì·¨ì•½í•œ ì‹œê°„ëŒ€ ì´ìœ ëŠ”?",
             ["ì—…ë¬´ì‹œê°„", "ì‹¬ë¦¬ì  ê²½ê³„ ì•½í•¨(ì•¼ê°„/ì£¼ë§)", "ì ì‹¬ì‹œê°„"], 1, "ì‹¬ë¦¬"),
            ("â€˜íœ´ëŒ€í° ê³ ì¥ì´ë¼ ë§í¬ë¡œ ëŒ€í™”â€™ ìš”êµ¬ì˜ ëª©ì ì€?",
             ["ë³´ì•ˆì±„ë„", "í”¼ì‹± í˜ì´ì§€ ìœ ë„", "ì‚¬ì§„ ê³µìœ "], 1, "ë§í¬ì£¼ì˜"),
            ("ì§€ì¸ ì‚¬ì¹­ í”¼í•´ë¥¼ ì¤„ì´ëŠ” ìŠµê´€ì€?",
             ["ì˜ìƒí†µí™”/ìŒì„±í™•ì¸", "ë¬¸ì íšŒì‹ ", "SNS í™•ì¸"], 0, "ë³¸ì¸í™•ì¸"),
            ("ê³„ì¢Œì´ì²´ ì „ ë°˜ë“œì‹œ í•´ì•¼ í•  ì ˆì°¨ëŠ”?",
             ["ì…ê¸ˆ ë©”ëª¨ ë‚¨ê¸°ê¸°", "ë‹¤ë¥¸ ì±„ë„ë¡œ ë³¸ì¸í™•ì¸", "ATM ì‚¬ìš©"], 1, "ë³¸ì¸í™•ì¸"),
            ("ì‹ ê³ /ìƒë‹´ ì°½êµ¬ë¡œ ì•Œë§ì€ ê³³ì€?",
             ["112/1332", "í•™êµ í–‰ì •ì‹¤", "SNS"], 0, "ì‹ ê³ "),
        ],
        "hard": [
            ("ë”¥í˜ì´í¬/í”„ë¡œí•„ ë„ìš©í˜• ì‚¬ì¹­ì— ìœ íš¨í•œ ê²€ì¦ì€?",
             ["ë¬¸ì ë§ì¶¤ë²• ê²€ì‚¬", "ì‹¤ì‹œê°„ ìŒì„±/ì˜ìƒ í™•ì¸", "í”„ë¡œí•„ ì‚¬ì§„ í™•ëŒ€"], 1, "ë³¸ì¸í™•ì¸"),
            ("â€˜ê²€ì¦ëœ ì—ìŠ¤í¬ë¡œâ€™ë¼ë©° ë§í¬ ê²°ì œ ìœ ë„. ìœ„í—˜ ë³¸ì§ˆì€?",
             ["ê²°ì œ í¸ì˜", "ê°€ì§œ ì—ìŠ¤í¬ë¡œë¡œ ìê¸ˆ íƒˆì·¨", "í¬ì¸íŠ¸ ì œê³µ"], 1, "ì •ë³´íƒˆì·¨"),
            ("â€˜ê³µë™êµ¬ë§¤ ì…ê¸ˆâ€™ ì§€ì‹œì— ëŒ€í•œ ì˜¬ë°”ë¥¸ ëŒ€ì‘ì€?",
             ["ì¦‰ì‹œ ì†¡ê¸ˆ", "ì „í™” ì—°ê²°ë¡œ ë³¸ì¸í™•ì¸", "ë¬¸ì ë³´ê´€"], 1, "ë³¸ì¸í™•ì¸"),
            ("ê°€ì¡± ì‚¬ì¹­ ì˜ì‹¬ì„ í™•ì •í•˜ëŠ” ì‹ í˜¸ëŠ”?",
             ["ëˆ ìš”êµ¬+ê¸´ê¸‰ì„±+ì™¸ë¶€ ë§í¬", "ì¸ì‚¬ë§", "ë§ì¶¤ë²•"], 0, "ì‹¬ë¦¬"),
            ("ì§€ì†ì  ì—°ë½ ìš”êµ¬ì™€ ì‹œê°„ ì••ë°•ì´ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ”?",
             ["ë°°ë ¤", "ì˜ì‚¬ê²°ì • ì°¨ë‹¨ ì‹œë„", "ì‹ ë¢°"], 1, "ì‹¬ë¦¬"),
        ],
    },
    "ê¸ˆìœµ/ëŒ€ì¶œ ì‚¬ì¹­": {
        "easy": [
            ("ì€í–‰ì´ ë¬¸ìë¡œ ëŒ€ì¶œ ê¶Œìœ /ì†¡ê¸ˆ ìš”ì²­ì„ í•œë‹¤(O/X)",
             ["O","X","ìƒí™©ì— ë”°ë¼"], 1, "ì†¡ê¸ˆë¶ˆê°€"),
            ("â€˜ì •ë¶€ ê¸´ê¸‰ëŒ€ì¶œ ì˜¤ëŠ˜ ë§ˆê°â€™ ë¬¸êµ¬ì˜ ëª©ì ì€?",
             ["ì •ë³´ ì œê³µ", "ì‹œê°„ ì••ë°• ìœ ë„", "ì œë„ ì•ˆë‚´"], 1, "ì‹¬ë¦¬"),
            ("ê¸ˆìœµ ìŠ¤ë¯¸ì‹±ì˜ í”í•œ ìˆ˜ë²•ì€?",
             ["ì•± ì„¤ì¹˜ ìœ ë„ í›„ ì•…ì„±ì½”ë“œ", "ì¿ í° ë°œì†¡", "í™ë³´"], 0, "ì•…ì„±ì•±"),
            ("ëŒ€ì¶œ ì¡°íšŒ/ìƒë‹´ì€ ì–´ë””ì„œ í•´ì•¼ ì•ˆì „í•œê°€?",
             ["ë§í¬ í´ë¦­", "ì€í–‰ ê³µì‹ ì•±/ì½œì„¼í„°", "SNS DM"], 1, "ëŒ€í‘œë²ˆí˜¸"),
            ("â€˜ìƒí™˜ìœ ì˜ˆ ìˆ˜ìˆ˜ë£Œ ì†¡ê¸ˆâ€™ ìš”êµ¬ì˜ ë³¸ì§ˆì€?",
             ["ì •ìƒ ì ˆì°¨", "ìê¸ˆ íƒˆì·¨", "ì´ë²¤íŠ¸"], 1, "ë³´í˜¸ì´ì²´"),
        ],
        "normal": [
            ("ì €ê¸ˆë¦¬ ë³€ê²½ì„ ë¯¸ë¼ë¡œ ìš”êµ¬í•˜ëŠ” ì •ë³´ëŠ”?",
             ["ì£¼ë¯¼ë²ˆí˜¸/ê³µë™ì¸ì¦ì„œ", "ë‹‰ë„¤ì„", "ì£¼ì†Œë¡"], 0, "ì •ë³´íƒˆì·¨"),
            ("â€˜ë³´ì•ˆ ê°•í™”ë¥¼ ìœ„í•´ ì›ê²©ì•± ì„¤ì¹˜â€™ ìš”êµ¬ì˜ ëª©ì ì€?",
             ["ë„ì›€", "ì›ê²©í†µì œÂ·ê°ˆì·¨", "ì„¤ì •ì´ì „"], 1, "ì•…ì„±ì•±"),
            ("ê¸ˆìœµì‚¬ì¹­ ì˜ì‹¬ ì‹œ ê°€ì¥ ì‹ ë¢°í•  ì±„ë„ì€?",
             ["ê²€ìƒ‰í•œ ëŒ€í‘œë²ˆí˜¸ ì¬í†µí™”", "ë¬¸ì íšŒì‹ ", "ì´ë©”ì¼ íšŒì‹ "], 0, "ëŒ€í‘œë²ˆí˜¸"),
            ("ê³„ì•½ì„œ/ì´ìœ¨ ì•ˆë‚´ íŒŒì¼ì´ ì²¨ë¶€ë˜ì—ˆì„ ë•Œ ì¡°ì¹˜?",
             ["ë°”ë¡œ ì—´ëŒ", "ì¶œì²˜ í™•ì¸+ê³µì‹ ì±„ë„ ì¬ìˆ˜ì‹ ", "í”„ë¦°íŠ¸"], 1, "ë„ë©”ì¸"),
            ("ì‹ ê³ /ìƒë‹´ ì°½êµ¬ëŠ”?",
             ["1332/112", "ì§€ì¸", "ì»¤ë®¤ë‹ˆí‹°"], 0, "ì‹ ê³ "),
        ],
        "hard": [
            ("â€˜ë³´í˜¸ê³„ì¢Œ/ì•ˆì „ê³„ì¢Œâ€™ë¡œ ëŒ€í”¼ ì†¡ê¸ˆ ìš”êµ¬ê°€ í—ˆìœ„ì¸ ì´ìœ ëŠ”?",
             ["íŠ¹ìˆ˜ì œë„", "ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê°œë…", "í•œì‹œì  í—ˆìš©"], 1, "ë³´í˜¸ì´ì²´"),
            ("í”¼ì‹± í˜ì´ì§€ì—ì„œ â€˜httpsâ€™ë§Œ ë³´ê³  ì•ˆì‹¬í•˜ë©´ ì•ˆ ë˜ëŠ” ì´ìœ ?",
             ["TLS ë¬´ìš©", "ë„ë©”ì¸ ìœ„ì¥ ê°€ëŠ¥", "í°íŠ¸"], 1, "ë„ë©”ì¸"),
            ("ì›ê²© ì•± ì„¤ì¹˜ í›„ ë‚˜íƒ€ë‚˜ëŠ” ì „í˜•ì  í”¼í•´ëŠ”?",
             ["í™”ë©´ ë°ê¸° ìƒìŠ¹", "ê³„ì¢Œ/ê³µë™ì¸ì¦ì„œ íƒˆì·¨", "í†µí™” í’ˆì§ˆ ì €í•˜"], 1, "ì•…ì„±ì•±"),
            ("ê¸ˆìœµì•± ì™¸ë¶€ ì„¤ì¹˜(ì‚¬ì´ë“œë¡œë”©) ìœ„í—˜ í•µì‹¬ì€?",
             ["ì„¤ì¹˜ í¸ì˜", "ê¶Œí•œ ë‚¨ìš©/ìš°íšŒ", "ì—…ë°ì´íŠ¸ ì§€ì—°"], 1, "ì•…ì„±ì•±"),
            ("ëŒ€ì¶œ ì‹¬ì‚¬ë¼ë©° ê³µë™ì¸ì¦ì„œ/OTP ìš”êµ¬. ë°”ë¥¸ ëŒ€ì‘ì€?",
             ["ë°”ë¡œ ì œê³µ", "ê±°ì ˆ í›„ ê³µì‹ ì±„ë„ ì¬ë¬¸ì˜", "ë¬¸ì íšŒì‹ "], 1, "ëŒ€í‘œë²ˆí˜¸"),
        ],
    },
    "ë³´ì´ìŠ¤í”¼ì‹± ì‹¬í™”": {
        "easy": [
            ("â€˜ê³„ì¢Œê°€ ë²”ì£„ì— ì´ìš©â€™ ë°œì–¸ì´ ë…¸ë¦¬ëŠ” ê°ì •ì€?",
             ["ê³µí¬/ë¶ˆì•ˆ", "ë³´ìƒì‹¬ë¦¬", "ê´€ì‹¬ìœ ë„"], 0, "ì‹¬ë¦¬"),
            ("ê²½ì°°ê´€ ì‚¬ì¹­ ì „í™”ì˜ ì „í˜•ì  íŠ¹ì§•ì€?",
             ["í†µí™” ì¤‘ ì†¡ê¸ˆ/ì´ì²´ ìš”êµ¬", "ë°©ë¬¸ ì•ˆë‚´", "ê³µë¬¸ ì´ë©”ì¼"], 0, "ì†¡ê¸ˆë¶ˆê°€"),
            ("â€˜í”¼ì‹± ì˜ˆë°©ì„¼í„°, ì •ë³´ ì¬í™•ì¸â€™ ë¬¸êµ¬ì˜ ìœ„í—˜ì„±ì€?",
             ["ê³µì‹ì¼ ìˆ˜ ìˆìŒ", "ê°œì¸ì •ë³´ íƒˆì·¨ ê°€ëŠ¥ì„± í¼", "í†µì‹ ì‚¬ ì ê²€"], 1, "ì •ë³´íƒˆì·¨"),
            ("ì˜ì‹¬ í†µí™” ì¢…ë£Œ í›„ ê°€ì¥ ë¨¼ì € í•  ì¼ì€?",
             ["ìƒëŒ€ì—ê²Œ í•­ì˜", "ëŒ€í‘œë²ˆí˜¸ë¡œ ì¬í™•ì¸", "ë¬¸ì íšŒì‹ "], 1, "ëŒ€í‘œë²ˆí˜¸"),
            ("ì‹ ê³ /ìƒë‹´ ê¸°ë³¸ ì°½êµ¬ëŠ”?",
             ["112/1332/118", "114", "ì§€ì¸"], 0, "ì‹ ê³ "),
        ],
        "normal": [
            ("â€˜ì‚¬ê±´ ì—°ë£¨â€™ í˜‘ë°•í˜• í†µí™”ì˜ ê³µí†µ ì „ìˆ ì€?",
             ["ì‹œê°„ ì••ë°•/ì˜ì‚¬ê²°ì • ì°¨ë‹¨", "ì¹œì ˆí•œ ìƒë‹´", "ê²½í’ˆ ì œê³µ"], 0, "ì‹¬ë¦¬"),
            ("í†µí™” ì¤‘ì— ì•± ì„¤ì¹˜Â·í™”ë©´ ê³µìœ ë¥¼ ìš”êµ¬í•˜ëŠ” ì´ìœ ëŠ”?",
             ["ë„ì›€", "ì›ê²©ì œì–´/ê°ˆì·¨", "ë³´ì•ˆê°•í™”"], 1, "ì•…ì„±ì•±"),
            ("ì‚¬ì¹­ì´ ì˜ì‹¬ë  ë•Œ ì´ë©”ì¼/ë¬¸ì„œì˜ ê°€ì¥ ì¤‘ìš”í•œ ê²€ì¦ì€?",
             ["ì„œì²´", "ë³´ë‚¸ ì‚¬ëŒ ì£¼ì†Œ/ë„ë©”ì¸", "ì¤„ê°„ê²©"], 1, "ë„ë©”ì¸"),
            ("â€˜ì„ì‹œ ë³´ê´€ê¸ˆâ€™ ì´ì²´ ìš”êµ¬ëŠ” ì™œ ìœ„í—˜í•œê°€?",
             ["ìŠ¹ì¸ ì§€ì—°", "ìê¸ˆ íƒˆì·¨ ìˆ˜ë²•", "ìˆ˜ìˆ˜ë£Œ ë°œìƒ"], 1, "ë³´í˜¸ì´ì²´"),
            ("í”¼í•´ ìµœì†Œí™”ë¥¼ ìœ„í•œ ì¦‰ì‹œ ì¡°ì¹˜ëŠ”?",
             ["ê³„ì¢Œ ì§€ê¸‰ì •ì§€+112/1332 ì‹ ê³ ", "ë‚´ì¼ ì€í–‰ ë°©ë¬¸", "ë©”ì‹œì§€ ë³´ê´€"], 0, "ì‹ ê³ "),
        ],
        "hard": [
            ("â€˜ê³µë™ì¡°ì‚¬íŒ€â€™/â€˜í•©ë™ìˆ˜ì‚¬ë°˜â€™ ëª…ëª© ì†¡ê¸ˆ ìš”êµ¬ì˜ ë²•ì  ì‹¤ì²´ëŠ”?",
             ["í•©ë²•", "í—ˆìœ„", "ì¼ë¶€ í—ˆìš©"], 1, "ë³´í˜¸ì´ì²´"),
            ("ì›ê²©ì œì–´ ì•±ìœ¼ë¡œ íƒˆì·¨ ê°€ëŠ¥í•œ ì •ë³´ëŠ”?",
             ["ë‚ ì”¨", "ì¸ì¦ì„œ/ê³„ì¢Œ/ë¬¸ì", "ë°°í„°ë¦¬"], 1, "ì•…ì„±ì•±"),
            ("https í™˜ê²½ì—ì„œë„ í”¼ì‹±ì´ ê°€ëŠ¥í•œ ì´ìœ ëŠ”?",
             ["TLS ë¬´ìš©", "ë„ë©”ì¸ ìœ„ì¥ ê°€ëŠ¥", "ë¸Œë¼ìš°ì € ì˜¤ë¥˜"], 1, "ë„ë©”ì¸"),
            ("ìˆ˜ì‚¬ê¸°ê´€ì€ ì „í™”ë¡œ ë¬´ì—‡ì„ ì ˆëŒ€ ìš”êµ¬í•˜ì§€ ì•ŠëŠ”ë‹¤?",
             ["ì‚¬ì‹¤í™•ì¸", "ì†¡ê¸ˆ/ê³„ì¢Œì´ì²´", "ë°©ë¬¸"], 1, "ì†¡ê¸ˆë¶ˆê°€"),
            ("ê±°ì§“ ë§í¬ë¡œ ë°›ì€ ê³ ì§€ì„œ/ì˜ìˆ˜ì¦ì˜ ê³µí†µ íŠ¹ì§•ì€?",
             ["ì •ì‹ ë„ë©”ì¸/ì„œëª…", "ë„ë©”ì¸ ìœ„ì¥+ê°œì¸ì •ë³´ ê³¼ë‹¤ ìš”êµ¬", "QR ë¯¸í¬í•¨"], 1, "ë„ë©”ì¸"),
        ],
    },
}

# ----------------------------
# ë³´ê¸° ë‹¤ì–‘í™” í’€(ìë™ ìƒì„±ìš©)
# ----------------------------
OPTION_POOLS = {
    "íƒë°° ìŠ¤ë¯¸ì‹±": [
        ["ë§í¬ í´ë¦­", "ê³µì‹ì•±/ì›¹ìœ¼ë¡œ ì§ì ‘ í™•ì¸", "ê²€ìƒ‰í•œ ëŒ€í‘œë²ˆí˜¸ë¡œ ë¬¸ì˜"],
        ["ë³´ë‚¸ ë²ˆí˜¸ë¡œ íšŒì‹ ", "ëŒ€í‘œë²ˆí˜¸ ì¬í†µí™”", "QRë¡œ ì ‘ì†"],
        ["ì£¼ì†Œ ì¬ì…ë ¥", "íƒë°°ì‚¬ ê³ ê°ì„¼í„°", "ë©”ì‹œì§€ ê³µìœ "],
    ],
    "ê³µê³µê¸°ê´€ ì‚¬ì¹­": [
        ["ë¬¸ì URL", "ê³µì‹ ì‚¬ì´íŠ¸ ì§ì ‘ í™•ì¸", "ëŒ€í‘œë²ˆí˜¸ë¡œ í™•ì¸"],
        ["í†µí™” ìœ ì§€", "112 ì‹ ê³ ", "1332 ìƒë‹´"],
        ["ë§í¬ ì ‘ì†", "ë„ë©”ì¸ í™•ì¸", "ë¬¸ì„œë²ˆí˜¸ ê²€ì¦"],
    ],
    "ê°€ì¡±/ì§€ì¸ ì‚¬ì¹­": [
        ["ë°”ë¡œ ì†¡ê¸ˆ", "ìŒì„±/ì˜ìƒìœ¼ë¡œ ë³¸ì¸ í™•ì¸", "ì¹´í†¡ìœ¼ë¡œë§Œ ëŒ€í™”"],
        ["í”„ë¡œí•„ë§Œ í™•ì¸", "ì „í™”ë¡œ ì¬í™•ì¸", "ë§í¬ ëŒ€í™”"],
        ["ë§í¬ ê²°ì œ", "ê³„ì¢Œ ê³µìœ ", "ëŒ€í‘œë²ˆí˜¸ ë¬¸ì˜"],
    ],
    "ê¸ˆìœµ/ëŒ€ì¶œ ì‚¬ì¹­": [
        ["ë§í¬ ìƒë‹´", "ì€í–‰ ê³µì‹ ì•±/ì½œì„¼í„°", "SNS DM"],
        ["ë³´í˜¸ê³„ì¢Œ ì†¡ê¸ˆ", "ëŒ€í‘œë²ˆí˜¸ ì¬í™•ì¸", "ì›ê²©ì•± ì„¤ì¹˜"],
        ["ì›ê²©ì•± ì„¤ì¹˜", "ì¸ì¦ì„œ ì œê³µ", "ì„œë¥˜ ì¬ìš”ì²­"],
    ],
    "ë³´ì´ìŠ¤í”¼ì‹± ì‹¬í™”": [
        ["ì¦‰ì‹œ ì†¡ê¸ˆ", "í†µí™” ì¢…ë£Œâ†’ëŒ€í‘œë²ˆí˜¸ ì¬í™•ì¸", "ë¬¸ì íšŒì‹ "],
        ["ì•± ì„¤ì¹˜", "ë„ë©”ì¸ í™•ì¸", "ì‹ ê³  112/1332"],
        ["ë§í¬ ì ‘ì†", "ì˜ì‹¬ ê¸°ë¡ ë³´ê´€", "ê°€ê¹Œìš´ ì§€êµ¬ëŒ€ ë°©ë¬¸"],
    ],
}

# ----------------------------
# í•´ì„¤ ìƒì„±ê¸° (ë§í¬ í¬í•¨)
# ----------------------------
def explain(scenario: str, key: str) -> str:
    L = LINKS
    if key == "íƒë°°-ëŒ€í‘œ":
        return f"íƒë°°ì‚¬ëŠ” ë¬¸ì ë§í¬ë¡œ ì£¼ì†Œ ìˆ˜ì •ì„ ìš”êµ¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë°˜ë“œì‹œ ê³µì‹ ì•±/ì›¹ ë˜ëŠ” {L['cj']}ë¡œ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”."
    if key == "ì‹¬ë¦¬":
        return "ìŠ¤ë¯¸ì‹±Â·í”¼ì‹±ì€ ëŒ€ì²´ë¡œ **ê¸´ê¸‰/ë¶ˆì•ˆ/ê¶Œìœ„**ë¥¼ ì´ìš©í•´ íŒë‹¨ì„ íë¦¬ê²Œ í•©ë‹ˆë‹¤. ì ì‹œ ë©ˆì¶”ê³  ê³µì‹ ì±„ë„ë¡œ ì¬í™•ì¸í•˜ì„¸ìš”."
    if key == "ì•…ì„±ì•±":
        return f"ë¬¸ì/í†µí™”ë¡œ **ì•± ì„¤ì¹˜**ë¥¼ ìœ ë„í•˜ë©´ ì•…ì„±ì½”ë“œÂ·ì›ê²©ì œì–´ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆì–´ìš”. ì„¤ì¹˜í–ˆë‹¤ë©´ ì¦‰ì‹œ ì‚­ì œÂ·ë°±ì‹  ê²€ì‚¬ í›„ {L['police']} / {L['fss']} ìƒë‹´."
    if key == "ì •ì‹ë„ë©”ì¸":
        return "ì •ì‹ ë„ë©”ì¸/ëŒ€í‘œë²ˆí˜¸/ëª…í™•í•œ íšŒì‹  ì ˆì°¨ê°€ ìˆëŠ”ì§€ ë³´ì„¸ìš”. ì• ë§¤í•œ ë§í¬Â·ë‹¨ì¶•URLì€ í”¼í•˜ì„¸ìš”."
    if key == "ì •ë³´íƒˆì·¨":
        return f"í•µì‹¬ ëª©ì ì€ **ê°œì¸/ê²°ì œì •ë³´ íƒˆì·¨**ì…ë‹ˆë‹¤. í”¼í•´ ë°œìƒ ì‹œ ì¦‰ì‹œ **ì§€ê¸‰ì •ì§€â†’{L['police']} / {L['fss']} ì‹ ê³ **, ìŠ¤ë¯¸ì‹±ì€ {L['kisa']} ì—ë„ ì‹ ê³ ."
    if key == "ë„ë©”ì¸":
        return "ìë¬¼ì‡ (https)ë§Œ ë¯¿ì§€ ë§ê³  **ì£¼ì†Œì°½ì˜ ì •í™•í•œ ë„ë©”ì¸**ì„ í™•ì¸í•˜ì„¸ìš”. ì² ì/í•˜ìœ„ë„ë©”ì¸ ìœ„ì¥ ì£¼ì˜."
    if key == "ëŒ€í‘œë²ˆí˜¸":
        return "ìˆ˜ì‹ í•œ ë²ˆí˜¸/ë§í¬ëŠ” ì‹ ë¢°í•˜ì§€ ë§ê³  **ê²€ìƒ‰í•´ì„œ ë‚˜ì˜¨ ê³µì‹ ëŒ€í‘œë²ˆí˜¸ë¡œ ìƒˆ í†µí™”**ë¥¼ í•´ì•¼ ì•ˆì „í•©ë‹ˆë‹¤."
    if key == "ë³´í˜¸ì´ì²´":
        return "â€˜ë³´í˜¸/ì•ˆì „ê³„ì¢Œâ€™ëŠ” **ì‚¬ê¸° ìˆ˜ë²•**ì…ë‹ˆë‹¤. ìˆ˜ì‚¬ê¸°ê´€Â·ì€í–‰ì€ **ì „í™”ë¡œ ì†¡ê¸ˆ**ì„ ìš”êµ¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¦‰ì‹œ {pol}/{fss} ìƒë‹´.".format(pol=L["police"], fss=L["fss"])
    if key == "êµí†µë¯¼ì›":
        return f"êµí†µë²”ì¹™ê¸ˆì€ ë¬¸ì URL ëŒ€ì‹  **{L['epass']}** ë“± **ê³µì‹ ì‚¬ì´íŠ¸**ì—ì„œ í™•ì¸í•˜ì„¸ìš”."
    if key == "ì†¡ê¸ˆë¶ˆê°€":
        return "ì •ë¶€Â·ìˆ˜ì‚¬ê¸°ê´€ì€ ì „í™”/ë¬¸ìë¡œ **ì†¡ê¸ˆ/ì´ì²´**ë¥¼ ìš”êµ¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìš”êµ¬ ì‹œ 100% ì˜ì‹¬í•˜ì„¸ìš”."
    if key == "ê±´ë³´":
        return f"ê±´ë³´ê³µë‹¨ì€ **ëŒ€í‘œì „í™”/ê³µì‹ ë„ë©”ì¸**ì„ ì•ˆë‚´í•©ë‹ˆë‹¤. ì˜ì‹¬ ì‹œ {L['nhis']}ìœ¼ë¡œ ì¬í™•ì¸í•˜ì„¸ìš”."
    if key == "í™ˆíƒìŠ¤":
        return f"ì„¸ê¸ˆ í™˜ê¸‰/ì²´ë‚©ì€ ë°˜ë“œì‹œ **{L['hometax']}**ì—ì„œ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”."
    if key == "ë³¸ì¸í™•ì¸":
        return "ê°€ì¡±/ì§€ì¸ ì‚¬ì¹­ì€ **ì „í™”/ì˜ìƒí†µí™”**ë¡œ **ë³¸ì¸ í™•ì¸**ì´ ìµœìš°ì„ ì…ë‹ˆë‹¤. ë¬¸ìëŠ” ì‰½ê²Œ ìœ„ì¡°ë©ë‹ˆë‹¤."
    if key == "ë§í¬ì£¼ì˜":
        return "ê²½ì¡°ì‚¬/ëŒ€í™” ì „í™˜ì„ ë¯¸ë¼ë¡œ ë§í¬ë¥¼ ëˆ„ë¥´ê²Œ í•©ë‹ˆë‹¤. ë§í¬ ëŒ€ì‹  ì „í™”ë¡œ ë³¸ì¸ í™•ì¸!"
    # fallback
    return "ì˜ì‹¬ë˜ë©´ ë§í¬/ì†¡ê¸ˆ ê¸ˆì§€ â†’ ëŒ€í‘œë²ˆí˜¸ ì¬í™•ì¸ â†’ 112/1332/118ì— ì‹ ê³ í•˜ì„¸ìš”."

# ----------------------------
# 10ë¬¸í•­ ìë™ í™•ì¥ (ë² ì´ìŠ¤ 5ê°œ + ê°€ë³€ 5ê°œ)
# - ë³´ê¸° ë‹¤ì–‘í™”/ì…”í”Œë¡œ ë‹¨ì¡°ë¡œì›€ ë°©ì§€
# ----------------------------
def build_ten(scenario: str, difficulty: str):
    base = BASE[scenario][difficulty][:]
    # ê°€ë³€ 5ë¬¸í•­ ìƒì„±
    pool = OPTION_POOLS[scenario]
    variants = []
    seeds = [
        ("ì˜ì‹¬ ë¬¸ìë¥¼ ë°›ì•˜ì„ ë•Œ ê°€ì¥ ë¨¼ì € í•  ì¼ì€?", [0,1,2], "ëŒ€í‘œë²ˆí˜¸"),
        ("ë§í¬ ì ‘ì† ì „ ë°˜ë“œì‹œ í™•ì¸í•  ê²ƒì€?", [1,2,0], "ë„ë©”ì¸"),
        ("ì†¡ê¸ˆ ìš”êµ¬ë¥¼ ë°›ì•˜ì„ ë•Œ ì˜¬ë°”ë¥¸ ëŒ€ì‘ì€?", [2,1,0], "ì†¡ê¸ˆë¶ˆê°€"),
        ("ì•± ì„¤ì¹˜/ì›ê²© ì œì–´ ìš”êµ¬ì˜ ëª©ì ì€?", [1,2,0], "ì•…ì„±ì•±"),
        ("ì‹ ê³ /ìƒë‹´ ì°½êµ¬ë¡œ ë§ëŠ” ê²ƒì€?", [2,1,0], "ì‹ ê³ "),
    ]
    for idx, (qtext, order, key) in enumerate(seeds):
        opts = pool[idx % len(pool)][:]
        # orderë¥¼ ì´ìš©í•´ ì •ë‹µ ì¸ë±ìŠ¤ ê²°ì •(í•­ìƒ ì•ˆì „ ì„ íƒì´ index 1ì´ ë˜ë„ë¡ êµ¬ì„±)
        # ì•ˆì „ ì˜µì…˜ í›„ë³´ë¥¼ ì¤‘ì•™ì— ë°°ì¹˜
        opts = [opts[i] for i in order]
        answer = opts.index([  # ì•ˆì „í•œ ì„ íƒ í‚¤ì›Œë“œ ì¶”ì •
            "ê³µì‹ì•±/ì›¹ìœ¼ë¡œ ì§ì ‘ í™•ì¸", "ëŒ€í‘œë²ˆí˜¸ ì¬í™•ì¸", "ì€í–‰ ê³µì‹ ì•±/ì½œì„¼í„°",
            "í†µí™” ì¢…ë£Œâ†’ëŒ€í‘œë²ˆí˜¸ ì¬í™•ì¸", "ë„ë©”ì¸ í™•ì¸", "112 ì‹ ê³ ",
            "1332 ìƒë‹´", "ìŒì„±/ì˜ìƒìœ¼ë¡œ ë³¸ì¸ í™•ì¸"
        ][0]) if False else 1  # ìœ„ ì¶”ì •ì€ ë³µì¡í•˜ë‹ˆ ì¤‘ì•™(1ë²ˆ)ì„ ì •ë‹µìœ¼ë¡œ ê³ ì •
        variants.append((qtext, opts, answer, key))
    # ë² ì´ìŠ¤ 5 + ê°€ë³€ 5 = 10
    items = base + variants
    # ë³´ê¸°/ë¬¸í•­ ìˆœì„œ ì„ê¸°
    mixed = []
    for q, opts, a, key in items:
        order = list(range(len(opts)))
        random.shuffle(order)
        new_opts = [opts[i] for i in order]
        new_a = order.index(a)
        mixed.append((q, new_opts, new_a, key))
    random.shuffle(mixed)
    return mixed[:10]

# ----------------------------
# ì‹œë‚˜ë¦¬ì˜¤Â·ë‚œì´ë„ ì„ íƒ UI
# ----------------------------
SCENARIOS = list(BASE.keys())
col = st.container()
with col:
    st.markdown('<div class="card">', unsafe_allow_html=True)
    s1, s2 = st.columns(2)
    with s1:
        scenario = st.selectbox("ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ", SCENARIOS, index=0)
        st.caption(BASE[scenario]["easy"][0][0])  # ë¯¸ë‹ˆìº¡ì…˜ ëŒ€ì²´
        st.write(f"ğŸ“ {BASE[scenario]['easy'][0][0].split('ë¬¸ìë¥¼')[0].strip()} Â· "
                 f"<span class='badge'>{scenario}</span>", unsafe_allow_html=True)
    with s2:
        difficulty = st.selectbox("ë‚œì´ë„ ì„ íƒ", ["easy","normal","hard"], index=1,
                                  format_func=lambda x: {"easy":"ğŸŸ¢ easy","normal":"ğŸŸ¡ normal","hard":"ğŸ”´ hard"}[x])
    count = st.slider("ë¬¸í•­ ìˆ˜", min_value=3, max_value=10, value=5, step=1)
    if st.button("í€´ì¦ˆ ì‹œì‘ ğŸ¯", use_container_width=True):
        st.session_state.quiz = {
            "scenario": scenario,
            "difficulty": difficulty,
            "qs": build_ten(scenario, difficulty),
            "idx": 0,
            "score": 0,
            "count": count,
        }
        st.success("í€´ì¦ˆë¥¼ ì‹œì‘í•©ë‹ˆë‹¤!")
    st.markdown('</div>', unsafe_allow_html=True)

# ----------------------------
# í€´ì¦ˆ ì§„í–‰
# ----------------------------
if "quiz" in st.session_state:
    qpack = st.session_state.quiz
    qs = qpack["qs"][:qpack["count"]]  # ì‚¬ìš©ìê°€ ê³ ë¥¸ ê°œìˆ˜ë§Œ
    idx = qpack["idx"]

    st.markdown('<div class="card">', unsafe_allow_html=True)
    st.write(f"ì§„í–‰ë¥ : **{idx}/{len(qs)}**")
    st.progress(idx/len(qs) if len(qs) else 0)

    if idx < len(qs):
        q, opts, answer, key = qs[idx]
        st.subheader(f"ë¬¸ì œ {idx+1} / {len(qs)}  Â·  {qpack['scenario']} Â· {qpack['difficulty']}")
        choice = st.radio("ì„ íƒ", opts, key=f"ch_{idx}", index=None)
        # ì œì¶œ â†’ í•´ì„¤ í‘œì‹œ, ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°€ëŠ” ë²„íŠ¼ ë¶„ë¦¬
        if st.button("ì •ë‹µ í™•ì¸ âœ…", key=f"check_{idx}", use_container_width=True, disabled=(choice is None)):
            st.session_state.last_choice = choice
            st.session_state.last_correct = (opts.index(choice) == answer)
            st.session_state.show_explain = True

        if st.session_state.get("show_explain"):
            ok = st.session_state.get("last_correct", False)
            user = st.session_state.get("last_choice", None)
            st.divider()
            if ok:
                st.success("ì •ë‹µì…ë‹ˆë‹¤! ğŸ‘")
                qpack["score"] += 1
            else:
                if user is None:
                    st.error("ì„ íƒ í›„ í™•ì¸ì„ ëˆŒëŸ¬ ì£¼ì„¸ìš”.")
                else:
                    st.error(f"ì˜¤ë‹µì…ë‹ˆë‹¤. ì„ íƒ: **{user}**")

            st.markdown("#### ğŸ’¬ í•´ì„¤")
            st.markdown(explain(qpack["scenario"], key))
            if st.button("ë‹¤ìŒ ë¬¸ì œ âœ", use_container_width=True):
                st.session_state.show_explain = False
                st.session_state.last_choice = None
                st.session_state.last_correct = None
                qpack["idx"] += 1
        st.markdown('</div>', unsafe_allow_html=True)

    else:
        st.success(f"ğŸ‰ ì™„ë£Œ! ì ìˆ˜ **{qpack['score']} / {len(qs)}**")
        if st.button("ë‹¤ì‹œ ì‹œì‘ ğŸ”", use_container_width=True):
            del st.session_state["quiz"]
            st.rerun()